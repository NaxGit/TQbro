<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./cascading/Mainstyles.css">
    <link rel="stylesheet" href="./cascading/Steptronic.css">
    <link rel="stylesheet" href="./cascading/Reportable.css">
    <link rel="stylesheet" href="./canvas/bootstrap.css">
    <script src="./caffeine/dexie.js"></script>
    <script src="./automate/Language.js"></script>
    <link href="./TABulator/tabulator.css" rel="stylesheet">
    <script type="text/javascript" src="./TABulator/tabulator.js"></script>
    <title>⊤⌕</title>
</head>
<body>
    <delta-head id="deltaHead"></delta-head>
    <search-bar id="searchBar"></search-bar>
    <div id="ReportTable">
        <table class="table table-sm table-dark">
            <thead>
              <tr>
                <th scope="col">Item</th>
                <th scope="col">Cost</th>
                <th scope="col">Sell</th>
                <th scope="col">Prof</th>
                <th scope="col">Qty</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
    </div>
	<div id="example-table"></div>
    <key-boards id="keyBoards"></key-boards>
    <delta-foot id="deltaFoot"></delta-foot>

<script type="module">

const Table = document.getElementById("ReportTable");

// const Index = await new Dexie("Queens").open().then().catch(Error, e => {window.location.href = "./Machining/upgrade.html";});

const idata = await new Dexie("Uchi").open();
const Stock = await idata.table("sales").toArray();

const list = document.getElementsByTagName("tbody")[0];

function icons()
{
    Stock.forEach((Item) =>
{
    let rowy = document.createElement("tr");

    rowy.innerHTML =
    `
    <td>${Item.Name}</td>
    <td>${Item.Cost}</td>
    <td>${Item.Sell}</td>
    <td>${Item.Sell - Item.Cost}</td>
    <td>${Item.Qtys}</td>
    `;

    let icon = document.createElement("th"); icon.textContent = Item.Imge;
    list.append(rowy);
});
}
icons();

var adultCalc = function(){
    var calc = 0;
    Stock.forEach(element => {
      let pro = element.Sell - element.Cost;

      calc = calc + pro;
    });
    return calc;
}
function tabul() {
var table = new Tabulator("#example-table", {
 	data:Stock, //assign data to table
 	layout:"fitColumns", //fit columns to width of table (optional)
 	columns:[ //Define Table Columns
	 	{title:"Name", field:"Name"},
	 	{title:"Cost", field:"Cost", topCalc:"sum"},
	 	{title:"Sell", field:"Sell", topCalc:"sum"},
		{title:"Profit", field:"Qtys", topCalc:adultCalc},
 	],
});

//trigger an alert message when the row is clicked
table.on("rowClick", function(e, row){ 
	alert("Row " + row.getData().id + " Clicked!!!!");
});
}

tabul();
</script>
</body>
</html>
